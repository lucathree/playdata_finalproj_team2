# Project DESLA

---

자율주행을 위한 이미지 기반 차선 객체 인식 서비스

- 진행기간 : 2021.10.25 ~ 2021.11.29
- 참여인원 : 총 3명 (1명 중도하차)
- 담당 포지션 : 팀장, 백엔드
- 사용기술 : Python, PyTorch, OpenCV, AWS, Ubuntu 18.04, FastAPI, Svelte
- 목표 : 카메라를 사용한 주행이미지 기반 차선, 정지전, 횡단보도 객체 인지 딥러닝 어플리케이션 구현

## 기획 사항

플레이데이터 인공지능 SW 개발 과정 최종 프로젝트로, 다소 난이도가 있지만 자율주행을 주제로 기획과 설계부터 개발환경 구축, 모델 학습 및 어플리케이션 구현까지 영상 처리 딥러닝 어플리케이션 개발의 전체 과정을 경험해보는 것을 목표로 진행되었습니다.

다만, 자율주행 어플리케이션을 구현하되 참여인원의 개발능력 수준과 현실적으로 사용가능한 자원의 한계를 고려하여 자율주행에 많이 사용되는 Lidar 센서 대신 카메라 촬영 영상 사용을 기준으로 했으며, 실제 차량을 위한 소프트웨어가 아닌 웹어플리케이션의 형태로 구현했습니다.

### 주요 기능

세 명의 팀원이 각각 아래의 구현 과제를 하나씩 담당하여 진행되었습니다.

1. **딥러닝 모델 학습 :** AI HUB ‘수도권 차량 주행 이미지 데이터셋’을 사용하여 차선 인식 모델 학습, 하이퍼 파라미터 튜닝 및 평가를 통해 최적화 진행
2. **추론 API 구축 :** 학습된 모델을 바탕으로 사용자로부터 전달받은 주행 이미지의 차선 객체를 인식하고 반환하는 추론 API 개발
3. **웹서비스 구현 :** 구축된 API를 기반으로 실질적인 사용자 서비스 제공을 위해 웹 기반 GUI 어플리케이션 구현
   
   

## 개발 과정

### 활용 데이터 수집

- 딥러닝 모델 학습을 위한 차량 주행 이미지를 직접 촬영하고 레이블링하기 어려우므로 AI HUB에서 차량 주행 개방 데이터를 사용했습니다.
- 데이터 활용 전 EDA를 진행하여 어노테이션 정보 및 환경별 데이터 비율 등 모델 학습에 영향을 미칠 수 있는 사항들을 사전 검토했습니다.

### 알고리즘 조사 및 선정

구현하고자 하는 목표에 맞춰 사용하기에 가장 적합한 딥러닝 알고리즘이 무엇인지 사전 자료조사를 진행했습니다. 이미지 처리가 필요하므로 CNN 알고리즘을 중심으로 자료조사가 진행되었으며, 이미지 내 차선 인식을 위해서는 차선 객체의 위치 파악이 필요하므로 영상 학습 알고리즘들 중 위치 정보가 소실되지 않는 FCN 알고리즘을 선정했습니다.

또한 정확한 객체 인식을 위해서는 이미지 해상도 저하가 일어나면 안되기 때문에 신경망 층이 깊어져도 기울기 소실이 일어나지 않는 ResNet 알고리즘이 backbone으로 사용된 FCN_resnet 알고리즘을 최종적으로 사용했습니다.

### 서비스 아키텍처

모델 학습 및 서비스 구축을 위해 AWS를 활용했습니다. 우분투 리눅스 배포판을 OS로 하는 EC2 인스턴스들을 만들어 각각 학습용 인스턴스, 백엔드 서버, 프론트엔드 서버로 사용했습니다. 또한 AWS EFS를 사용하여 학습용 인스턴스에서 만들어진 모델을 백엔드 서버에서 바로 이용할 수 있도록 했습니다.

딥러닝 모델 개발은 PyTorch와 PyTorch Lightning 프레임워크를 사용했으며, 상대적으로 개발 소요시간을 줄이고 다양한 프레임워크를 경험해보기 위해 FastAPI와 Svelte 프레임워크가 사용되었습니다.

### REST API 설계

프론트엔드 서버에서 사용자의 주행 이미지를 추론 서버로 전달하고, 차선이 인식되어 반환된 결과를 다시 추론 서버에서 프론트엔드 서버로 전달 받도록 하기 위해 REST 아키텍처 조건에 따른 API 를 설계했습니다.



## 프로젝트를 통한 경험

### 효율적인 환경 구축 및 DevOps의 필요성

해당 프로젝트를 진행하면서 가장 어려웠던 부분은 실질적인 코드를 작성하는 것 보다도 작성한 코드가 문제없이 돌아갈 수 있도록 환경을 구축하는 것이었습니다. 딥러닝 모델 학습 및 추론을 위해서 GPU를 사용할 수 있도록 해야하는데 이 과정에서 PyTorch 버전과 CUDA 버전 그리고 그래픽카드 버전을 모두 맞추고 제대로 실행이 되는지 확인하기까지 예상보다 많은 시간이 소요되었습니다.

그래서 이번 프로젝트에는 바로 사용하지 못했지만 프로젝트 종료 후 Docker를 사용하여 환경 구축을 보다 효율적으로 만드는 방법에 대해 추가적인 공부를 진행했습니다.

또한 팀원들 개인이 가지고 있는 컴퓨터 성능의 한계를 보완하고 공동으로 작업을 하여 배포까지 하기 위해 AWS 및 Git을 처음 사용했는데, 팀 단위로 프로젝트를 진행한다는 것은 단순히 각자 작성한 코드를 취합하는 것만이 아니며 그 이상으로 개발 운영에 공을 들여야 한다는 중요성을 느꼈습니다.

### 팀 프로젝트 리드

이전 프로젝트들에서도 팀장 역할을 맡아보기는 했지만 Project DESLA를 진행하면서 팀장의 역할에 대해 더 진지하게 고민을 했었습니다. 해당 프로젝트에서는 개발 뿐만 아니라 초기 기획부터 산출물 작성까지 더 다양한 업무를 소화해내야 했으며 이 과정에서 커뮤니케이션이 상당히 중요했습니다.

특히 교육과정 최종 프로젝트라는 무게감으로 인해 초반부터 팀원들의 사기가 저하되어 있었고, 원래 4명이었던 팀원들 중 한 명이 중도탈락을 하게되면서 남은 인원이 더 많은 책임과 부담을 나눠가져야 했기 때문에 이 부분을 극복하고 마지막까지 좋은 결과물을 만들어내기 위한 과정에 힘을 많이 썼던 것 같습니다.

팀원들이 힘들어 할 때는 팀장으로서 조금 더 짐을 지고 가려고 했으며, 또 다같이 전진할 수 있도록 하기 위해 팀원들에게 각자 맡은 자리에서 잘해주고 있다는 격려와 동시에 저 혼자서는 해낼 수 없는 부분들을 믿고 맡겨줌으로써 팀원들의 가치를 인정하고 동기부여를 해주려 노력했습니다. 그리고 개발도 결국 혼자서 하는 일이 아니고 좋은 커뮤니케이션과 협력이 필요함을 배웠습니다.



## 프로젝트 결과물

- [프로젝트 발표자료](https://drive.google.com/file/d/1YzdsH04RATdG4K3EYcX-ch4b-nFfK2cM/view?usp=sharing)
- [시연영상](https://youtu.be/pltea5ZG8MQ)
